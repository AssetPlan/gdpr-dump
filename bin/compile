#!/usr/bin/env php
<?php
use Smile\GdprDump\AppKernel;
use Smile\GdprDump\Compiler;
use Smile\GdprDump\Console\Application;

$basePath = dirname(__DIR__);

// Initialize autoload
require $basePath . '/app/bootstrap.php';

// Prepare the file name
$fileName = $basePath . '/build/dist/gdpr-dump-' . Application::VERSION . '.phar';

try {
    // Force the generation of the container cache
    $application = new AppKernel();
    $application->initialize();

    // Create the phar file
    $compiler = new Compiler();
    $compiler->compile($fileName);
} catch (RuntimeException $e) {
    die('ERROR: ' . $e->getMessage() . "\n");
}
