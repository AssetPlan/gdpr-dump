services:
    app:
        build: 'docker/php-cli'
        user: '${UID:-}:${GID:-}'
        environment:
            COMPOSER_AUTH: '${COMPOSER_AUTH:-}'
            DB_HOST: 'db'
        depends_on:
            - 'db'
        volumes:
            - '.:/var/www/html'
            - 'composer-cache:/tmp/composer'

    db:
        image: 'mariadb:10.6'
        ports:
            - 3306
        environment:
            MYSQL_ROOT_PASSWORD: '!root'
            MYSQL_DATABASE: 'tests'
            MYSQL_USER: 'tests'
            MYSQL_PASSWORD: 'tests'
        volumes:
            - 'db-data:/var/lib/mysql'
            - './docker/db-data:/docker-entrypoint-initdb.d'

volumes:
    composer-cache:
    db-data:
